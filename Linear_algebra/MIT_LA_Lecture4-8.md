[TOC]

# 0 说明

**笔记标题**：MIT_LA_Lecture4-8

**笔记版本**：v1.0

**对于文档的说明**：

1. 你可以在我的Github[仓库](https://github.com/agoclover/machine_learning/tree/master/Linear_algebra)中下载本笔记的Markdwon源文档，并通过浏览目录进行更方便高效地浏览；也欢迎在[知乎文章](https://zhuanlan.zhihu.com/p/74532717)中进行浏览。
2. 本笔记参考的课程为MIT Linear Algebra（麻省理工线性代数），本课程在[网易公开课](http://open.163.com/special/opencourse/daishu.html)、[Bilibili](https://www.bilibili.com/video/av4042095)和[youtube](https://www.youtube.com/watch?v=ZK3O402wf1c&list=PLE7DDD91010BC51F8&index=1)等网站上都有视频资源，读者可以选择合适的平台观看。
3. 本笔记并未完全按照视频课的内容记录，添加了许多自己的理解、资料的补充和顺序的调整。
4. 本系列笔记在不断更新，已经发布的笔记也会偶尔进行内容更新，版本号可以在文件标题或说明的开头查看，你可以通过Github的commit信息来查看笔记更新内容。
5. 如果你对笔记内容有好的建议，请提出来，笔者在这里表示感谢。

**对于内容的说明**：

1. 小写字母表示的向量，比如 $$\vec{a}$$ ，除非在特殊说明的情况下，都表示的是列向量。用 $${\vec{a}}^{T}$$ 来表示行向量。
2. 部分矩阵中 `.` 用来表示元素省略，并不表示元素为 0 。
3. 单位矩阵用 $$I$$ 表示。



# 4.1 矩阵的 $$LU$$ 分解

## 为什么需要 $$LU$$ 分解

在[上一节](https://github.com/agoclover/machine_learning/blob/master/Linear_algebra/MIT_LA_Lecture1-3_v1.2.md)中，我们知道通过高斯消元法可以容易地求解线性方程组，用矩阵表示即 $$EA=U$$ ， $$E$$ 为若干初等矩阵的积，包含了我们进行初等变换的所有信息， $$U$$ 为上三角矩阵（upper triangular）。我们以 1 中（6）为例 $${E}_{32}{E}_{21}A =U$$ ：
$$
\left[
	\begin{matrix}
	1 & 0 & 0 \\
  0 & 1 & 0 \\
  0 & -2 & 1
	\end{matrix}
\right]
\left[
	\begin{matrix}
	1 & 0 & 0 \\
  -3 & 1 & 0 \\
  0 & 0 & 1
	\end{matrix}
\right]
\left[
	\begin{matrix}
	1 & 2 & 1 \\
  3 & 8 & 1 \\
  0 & 4 & 1
	\end{matrix}
\right]
=
\left[
	\begin{matrix}
	1 & 2 & 1\\
  0 & 2 & -2\\
  0 & 0 & 5
	\end{matrix}
\right]
\tag{1}
$$
我们先**不考虑行的交换**，观察 $${E}_{32}{E}_{21}=E$$ ：
$$
\left[
	\begin{matrix}
	1 & 0 & 0 \\
  0 & 1 & 0 \\
  0 & -2 & 1
	\end{matrix}
\right]
\left[
	\begin{matrix}
	1 & 0 & 0 \\
  -3 & 1 & 0 \\
  0 & 0 & 1
	\end{matrix}
\right]
=
\left[
	\begin{matrix}
	1 & 0 & 0 \\
  -3 & 1 & 0 \\
  -6 & -2 & 1
	\end{matrix}
\right]
\tag{2}
$$
我们可以发现， $$E$$ 除了初等行变换信息（即 $$E$$ 中的-3，-2两项），还多了一个额外信息-6，这个是我们不想要的信息，那么有没有只包含行变换信息的分解或等式呢？有，这就是我们即将介绍的 $$LU$$ 分解。



## $$LU$$ 分解

> 在线性代数与数值分析中， $$LU$$ 分解是矩阵分解的一种，将一个矩阵分解为一个**下三角矩阵**和一个**上三角矩阵**的乘积，有时需要再乘上一个**置换矩阵**。 $$LU$$ 分解可以被视为高斯消元法的矩阵形式。在数值计算上， $$LU$$ 分解经常被用来解线性方程组、且在求反矩阵和计算行列式中都是一个关键的步骤。 
>
> --[维基百科](https://zh.wikipedia.org/wiki/LU%E5%88%86%E8%A7%A3)

仍先不考虑行变换， $$LU$$ 分解简单地说就是 $$A=LU$$ ，同样写出上例的 $$LU$$ 分解式：
$$
\left[
	\begin{matrix}
	1 & 2 & 1 \\
  3 & 8 & 1 \\
  0 & 4 & 1
	\end{matrix}
\right]
=
\left[
	\begin{matrix}
	1 & 0 & 0 \\
  3 & 1 & 0 \\
  0 & 2 & 1
	\end{matrix}
\right]
\left[
	\begin{matrix}
	1 & 2 & 1\\
  0 & 2 & -2\\
  0 & 0 & 5
	\end{matrix}
\right]
\tag{3}
$$
可以看到， $$L$$ 除了是下三角阵外，还**包含且仅包含**了矩阵行变换的所有信息。同时我们有以下结论：
$$
EA=U\\
A=LU\\
∴L={E}^{-1}
\tag{4}
$$
这样，当我们通过高斯消元法变换矩阵后，就能立即写出 $$A=LU$$ 这种分解形式，对**消元的过程和结果**进行完整地记录，而不需要额外去计算 $$E={E}_{32}{E}_{21}$$ ，我们写出$$L$$就相当于记录了 $$E$$ ，因为 $$L={E}^{-1}$$ 。

**总之**，对于 $$A=LU$$ ，如果不存在行交换，消元乘数（消元步骤中需要乘以并减去的倍数）可以直接写入 $$L$$ 中。因此可以这样看待消元，只要步骤正确，就可以在得到 $$LU$$ 的过程中把 $$A$$ 抛开，这是对矩阵形式进行消元的更深刻的认识。



## 其他分解形式

除了上面给出的 $$LU$$ 分解，有些矩阵还能进行 $$PLU$$ 分解和 $$LDU$$ 分解。

### $$PLU$$ 分解

方阵 $$A$$ 的 **$$PLU$$ 分解**是是将它分解成一个**置换矩阵**  $$P$$ 、**一个下三角矩阵**  $$L $$ 与**上三角矩阵**  $$U$$  的乘积，即
$$
A=PLU\tag{5}
$$
事实上，所有的方阵都可以写成 $$PLU$$ 分解的形式，由于左乘排列矩阵 $${P}^{-1}$$ 是在交换行的顺序（也就是后面即将说到的置换矩阵），所以由 $${P}^{-1}A=LU$$ 推得适当的交换 $$A$$ 的行的顺序，即可将 $$A$$ 做 $$LU$$ 分解。事实上，$$PLU$$ 分解有很高的[数值稳定性](https://zh.wikipedia.org/wiki/数值稳定性)，因此实用上是很好用的工具。

有时为了计算上的方便，会同时间换行与列的顺序，此时会将 $$A$$ 分解成
$$
A=PLUQ\tag{6}
$$
其中 $$P$$、$$L$$、$$U$$ 同上，$$Q$$ 是一个置换矩阵（这里是右乘以交换列）。

### $$LDU$$ 分解

方阵 $$A$$ 的 **LDU 分解**是是将它分解成一个**单位下三角矩阵** $$L$$、**对角矩阵** $$D$$ 与**单位上三角矩阵** $$U$$ 的乘积，即
$$
A=LDU\tag{7}
$$
其中单位上、下三角矩阵是指对角线上全是 1 的上、下三角矩阵。

事实上，$$LDU$$ 分解可以推广到 $$A$$ 是一般的矩阵，而非方阵。此时，$$L $$ 和 $$D $$ 是方阵，并且与 $$A $$ 有相同的行，$$U$$ 则有和 $$A$$ 相同的长宽。注意到现在 $$U$$ 是上三角的定义改为主对角线的下方都是 0，而主对角线是收集所有 $${U}_{ij}$$ 满足  $$ i=j$$ 。

我们将（3）中的 $$A=LU$$ 分解再进一步化为 $$LDU$$ 分解：
$$
\left[
	\begin{matrix}
	1 & 2 & 1 \\
  3 & 8 & 1 \\
  0 & 4 & 1
	\end{matrix}
\right]
=
\left[
	\begin{matrix}
	1 & 0 & 0 \\
  3 & 1 & 0 \\
  0 & 2 & 1
	\end{matrix}
\right]
\left[
	\begin{matrix}
	1 & 0 & 0\\
  0 & 2 & 0\\
  0 & 0 & 5
	\end{matrix}
\right]
\left[
	\begin{matrix}
	1 & 2 & 1\\
  0 & 1 & -1\\
  0 & 0 & 1
	\end{matrix}
\right]
\tag{8}
$$

# 4.2 高斯消元算法复杂度

关于高斯消元算法的复杂度：

1. 用每一行减去第一行的倍数，以消除第一行以外的第一列的元素，因为每行有 $$n$$ 个元素，所以计算次数为 $${n}^{2}$$ ；

2. 排除第一行，用每一行减去第二行的倍数，计算以此类推，因为共有 $$n$$ 行，所以我们一共进行了 $$n$$ 次，算法复杂度为  $${n}^{2}+{(n-1)}^{2}+…+{1}^{2}=O(\frac{1}{3}{n}^{3})$$ 。

3. 这里我们仅讨论得到阶梯型矩阵的复杂度，高斯-若当消元法会有额外的计算步骤，但后续计算量小，并不影响其复杂度，这里不予证明。



# 4.3 转置矩阵

## 转置矩阵的性质

转置矩阵（transpose）有很多值得我们记住的基本的性质，对于矩阵 $$A$$, $$B$$ 和标量 $$c$$，转置矩阵有下列性质：

- $${({A}^{T})}^{T}=A$$
- $${ \left( A+B \right)  }^{ T }={ A }^{ T }+{ B }^{ T }$$
- $${ \left( AB \right)  }^{ T }={ B }^{ T }{ A }^{ T }$$
- $${ \left( cA \right)  }^{ T }=c{ A }^{ T }$$
- $$\left| { A }^{ T } \right| =\left| A \right| $$
- $$\vec { a } \cdot \vec { b } ={ \vec { a }  }^{ T }\vec { b } $$
- 若 $$A{A}^{T}=C$$ ，则 $$C$$为对称矩阵，即 $$C={C}^{T}$$ 。

还有比如我们刚刚学到的：
$$
A{ A }^{ -1 }=I\overset { T }{ \rightarrow  } { \left( { A }^{ -1 } \right)  }^{ T }{ A }^{ T }=I\rightarrow { \left( { A }^{ T } \right)  }^{ -1 }={ \left( { A }^{ -1 } \right)  }^{ T }
\tag{9}
$$
当然，还有一些之后会学到的：

- 如果 $$A$$ 只有实数元素，则 $${A}^{T}A$$ 是半正定矩阵。
- 如果 $$A$$ 是在某个域上，则 $$A$$ 相似与 $${A}^{T}$$ 。



## 特殊转置矩阵

### 对称矩阵

其转置等于自身的方块矩阵叫做**对称矩阵**。

### 正交矩阵

其转置也是它的逆矩阵的方块矩阵叫做**正交矩阵**；就是说 $$G$$ 是正交的，如果 $$G{ G }^{ T }={ G }^{ T }G=I$$ 。

### 斜对称矩阵

其转置等于它的负矩阵的方块矩阵叫做斜对称矩阵；就是A是斜对称的，如果 $${ A }^{ T }=-A$$ 。

 

# 4.4 置换矩阵

## 置换矩阵的定义

在以上的消元的讨论中，我们为了方便都事先假定不需要进行行的交换，如果需要考虑这些行交换或列交换， $$A=LU$$ 分解就不能完全表示出矩阵消元的所有信息了，这个时候我们需要在 $$LU$$ 左边乘上一个置换矩阵，用以记录行交换的信息，从而我们得到了 $$A=PLU$$ 分解；当然，有时候我们也会进行列交换，那么同样地在 $$LU$$ 右端乘上一个置换矩阵，就得到了 $$A=PLUQ$$ 分解。

> 在数学中的矩阵论里，置换矩阵（permutation matrix）是一种系数只由0和1组成的方块矩阵。置换矩阵的每一行和每一列都恰好有一个1，其余的系数都是0。在线性代数中，每个n阶的置换矩阵都代表了一个对 $$n$$ 个元素（ $$n$$ 维空间的基）的置换。当一个矩阵乘上一个置换矩阵时，所得到的是原来矩阵的横行（置换矩阵在左）或纵列（置换矩阵在右）经过置换后得到的矩阵。
>
> 来自[维基百科](https://zh.wikipedia.org/wiki/%E7%BD%AE%E6%8D%A2%E7%9F%A9%E9%98%B5)。

我们考虑 $$ n=3$$时的置换矩阵，一共有以下6个：
$$
\qquad \left[ \begin{matrix} 1 &  &  \\  & 1 &  \\  &  & 1 \end{matrix} \right] \left[ \begin{matrix} 1 &  &  \\  &  & 1 \\  & 1 &  \end{matrix} \right] \left[ \begin{matrix}  & 1 &  \\ 1 &  &  \\  &  & 1 \end{matrix} \right] \left[ \begin{matrix}  & 1 &  \\  &  & 1 \\ 1 &  &  \end{matrix} \right] \left[ \begin{matrix}  &  & 1 \\ 1 &  &  \\  & 1 &  \end{matrix} \right] \left[ \begin{matrix}  &  & 1 \\  & 1 &  \\ 1 &  &  \end{matrix} \right] 
\tag{10}
$$
相应地，左乘分别代表不变，交换2、3行，交换1、2行等；右乘分别代表不变，交换2、3列，交换1、2列等。



## 置换矩阵的性质

- 从定义可以看出，$$n$$ 维置换矩阵共有 $$n!$$ 个。

- 从定义也可以很容易得到，置换矩阵的逆等于其转置，即 $${P}^{-1}={P}^{T}$$ 。
- 这 $$n!$$ 个置换矩阵任意相乘的结果仍在其中，其逆也在其中，也就是这 $$n!$$ 个矩阵构成了一个[矩阵群](https://zh.wikipedia.org/wiki/%E7%9F%A9%E9%98%B5%E7%BE%A4)，对矩阵乘法和逆运算封闭。



# 5 向量空间

## 空间

什么是空间？如果让一只蚂蚁沿着一条细绳爬行，那么对蚂蚁来说，空间就是一条直线 $$R$$ ，如果把蚂蚁放到地图上，那么空间就是一个平面 $$R^2$$ ，而现实里，蚂蚁还能往上往下，那么就像我们人类感知的一样，空间就是三维空间 $$R^3$$ 。

而数学上，空间是指一种具有特殊性质及一些额外结构的集合，也就是说，我们规定一些性质或结构，若集合能满足这些要求，那它就是一个我们规定的某种空间。在数学上，空间可以有很多种，比如函数空间、仿射空间、概率空间等等，向量空间也是规定的一种满足特定性质和要求的**元素**的集合。

那么，从这个定义来说，向量空间里的元素只要满足这些要求就行了，是不是向量空间里的元素不是向量也可以呢？还真是这样。向量空间的元素还可以是函数、矩阵、多项式、映射等等，只要这些元素满足向量空间的所规定的线性运算规律就好了。

但正如名字所示，我们最常见和研究的向量空间还是一些有序数组，也就是向量的集合，这一节我们还是以它为主介绍。

那么，向量空间应该满足什么性质呢？



## 向量空间的定义

设 $$V$$ 为 $$n$$ 维向量的集合，如果集合 $$V$$ 非空，且集合 $$V$$ 对于向量的加法及数乘两种运算封闭，那么就称集合 $$V$$ 为向量空间。所谓封闭，是指在集合 $$V$$ 中可以进行向量的加法及数乘两种运算。具体地说：
$$
若\vec { a } ,\vec { b } \in V，则\vec { a } +\vec { b } \in V；\\
若\vec { a } \in V，\lambda \in R，则\lambda \vec { a } \in V。
\tag{11}
$$
当然，我们这里前提还是以有序数组，即向量为对象考虑的，对于一般化的向量空间，我们会在后面介绍。



## 常见的向量空间

在思考这个问题之前，我们先回过头看一看（6）这个定义，其中 $$\vec { a } ,\vec { b }$$ 既然可以相加，首先它们的维数必须相同，也就是说，不同维数的向量构成的向量空间肯定是不同的，比如，举个最简单的例子，两个集合A和B，$$A=\left\{ \vec { 0 } ={ \left[ 0,0 \right]  }^{ T } \right\} $$，$$B=\left\{ \vec { 0 } ={ \left[ 0,0,0 \right]  }^{ T } \right\} $$，很容易验证这两个向量都分别满足向量空间的定义，但它们是不同的向量空间。

同样地，我们还能举出一个例子 $$R$$ , $$R^2$$ ，和 $$R^3$$ 都是向量空间，可以说是 $$n$$ 维列向量能构成的最大的向量空间。

还有哪些呢？比如我们考虑 $$R^2$$ 内，一条过原点的直线也是一个向量空间，因为我们很容易能验证（6）中的两条性质。但线段、射线和不过原点的直线都不是向量空间，也就是没有其他种类的向量空间了。

我们再考虑 $$R^3$$ 中，同样，过原点的直线是向量空间，更进一步，过原点的任一平面也是一个向量空间，也没有其他种类的向量空间了。

现在我们再加上最开始考虑的零向量和 $$R^n$$ 本身，总结一下， $$R^n$$ 中，一共有多少种向量空间呢？

首先是零向量，然后是 $$R^n$$ 中任一过原点的直线，然后是$$R^n$$中任一过原点的平面，当 $$n=4$$ 时，还有 $$R^4$$ 中任一过原点的三维空间，当然4维是抽象的， $$n>4$$时以此类推。最后再加上 $$R^n$$ 本身，就是 $$R^n$$ 内所有不同种类的向量空间，共有 $$n+1$$ 种。



## 向量空间的子空间

我们知道了 $$R^n$$ 中，一共有 $$n+1$$ 种向量空间，并且，前 $$n$$ 种向量空间都是 $$R^n$$ 的子集（当然 $$R^n$$ 本身也是 $$R^n$$ 的子集），那么就称前 $$n$$ 种低维向量空间是 $$R^n$$ 的**子空间**。

一个集合 $$A$$ 首先应该是一个向量空间，其次它是另一个向量空间 $$V$$ 的子集，这样它就是这个向量空间 $$V$$ 的子空间。

那么，是在 $$R^n$$ 中的这 $$n+1$$ 种向量空间，前 $$n$$ 种向量空间只能是 $$R^n$$ 的子空间吗？并不是，比如， $$R^n$$ 上的一个二维向量空间，即 $$R^n$$ 中一个过原点的平面，在其中任找一条过原点的直线，那么这条直线就是这个二维向量空间的子空间。当然， $$n$$ 维零向量也是 $$R^n$$ 中任一向量空间的子空间。



## 向量空间的基与维数

设 $$V$$ 为向量空间，如果 $$r$$ 和向量 $${ \vec { a }  }_{ 1 },{ \vec { a }  }_{ 2 },...,{ \vec { a }  }_{ r }\in V$$ ，且满足：

-  $${ \vec { a }  }_{ 1 },{ \vec { a }  }_{ 2 },...,{ \vec { a }  }_{ r }$$ 线性无关；
-  $$V$$ 中任一向量都可由 $${ \vec { a }  }_{ 1 },{ \vec { a }  }_{ 2 },...,{ \vec { a }  }_{ r }$$ 线性表示，

那么，向量组 $${ \vec { a }  }_{ 1 },{ \vec { a }  }_{ 2 },...,{ \vec { a }  }_{ r }$$ 就称为向量空间V的一个**基**， $$r$$ 称为向量空间V的**维数** $$dim \space V$$ ，并称 $$V$$ 为 $$r$$ 维向量空间。多说一句，如果 $${ \vec { a }  }_{ 1 }$$ 是m维列向量，那么我们通常称 $$V$$ 为 $$R^m$$ 上的 $$r$$ 维向量空间。

如果向量空间 $$V$$ 没有基，那么 $$V$$ 的维数是0。0维向量空间只含一个零向量 $$\vec{0}$$。

以上，我们介绍了向量空间的概念， 接下来介绍两种常用的向量空间来帮助理解和求解线性方程组 $$A\vec{x}=\vec{b}$$ ：**列空间**和**零空间**。



# 6.1 列空间

## 列空间的定义

设一 $$m$$ 行 $$n$$ 列实元素矩阵为 $${A}_{mn}$$ ，则其列空间（column space）是由矩阵 $$A$$ 的所有列向量张成（span）的 $$R^m$$ 上的子空间，记作 $$C(A)$$ 。

矩阵 $$A$$ 的列空间 $$C(A)$$ 中的所有向量均为矩阵 $$A$$ 中列向量的某种线性组合，都为 $$R^m$$ 上的向量（即 $$m$$ 维向量）。

$$C(A)$$的维度等于矩阵 $$A$$ 的列秩，最大为 $$min(m,n)$$ 。即：

$$
dim \space C(A) = rank(A) ≤ min(m,n)
\tag{12}
$$
列空间 $$C(A)$$ 的一组自然基底是矩阵 $$A$$ 的列向量的最大线性无关组。



## 线性方程组与列空间

我们考虑以下线性方程组 $$A\vec{x}=\vec{b}$$ ：
$$
\left[
	\begin{matrix}
	1 & 1 & 2\\
	2 & 1 & 3\\
	3 & 1 & 4\\
	4 & 1 & 5
	\end{matrix}
\right]
\left[
	\begin{matrix}
	{x}_{1}\\
	{x}_{2}\\
	{x}_{3}
	\end{matrix}
\right]
=
\left[
	\begin{matrix}
	{b}_{1}\\
	{b}_{2}\\
	{b}_{3}\\
	{b}_{4}
	\end{matrix}
\right]
\tag{13}
$$
我们很容易验证列空间 $$C(A)$$ 是一个向量空间。

A的列空间 $$C(A)$$ 为所有列的线性组合，因为第3列为前两列之和，前两列线性无关，所以 $$C(A)$$ 是 $$R^4$$ 上的一个2维向量空间。

那么，由（8）可知，求解线性方程组从列向量角度讲，本质就是 $$\vec{b}$$ 是否可以由系数矩阵 $$A$$ 的列向量线性表出。那么什么时候 $$A\vec{x}=\vec{b}$$ 解有什么时候无解呢？**从列空间的角度，当 $$\vec{b}\in C(A)$$ 时，线性方程组有解；反之则无解**。



# 6.2 零空间

## 零空间的定义

对于所有使齐次线性方程组 $$A\vec{x}=\vec{0}$$ 成立的向量 $$\vec{x}$$ 的集合，称为矩阵 $$A$$ 的零空间（null spaces），用符号表示为 $$N(A)$$ 。

零空间是一个向量空间。当 $$A$$ 为 $$m$$ 行 $$n$$ 列实元素矩阵，所以 $$\vec{x}$$ 是一个 $$n$$ 维列向量：

- 若 $$\vec{w} \in N(A)$$ ，则 $$A(k\vec{w})=kA\vec{w}=\vec{0}$$ ，即 $$k\vec{w} \in N(A)$$ ；

- 若 $$\vec{w} ,\vec{u}\in N(A)$$ ，则 $$A(\vec{w}+\vec{u})=A\vec{w}+A\vec{u}=\vec{0}$$ ，即 $$\vec{w} +\vec{u}\in N(A)$$ 。

所以 $$N(A)$$ 就是 $${R}^{n}$$ 的一个子空间。



## 零空间的维数

很容易知道， $$\vec{0}\in N(A)$$ ，以下我们来讨论 $$A\vec{x}=\vec{0}$$ 的非零解。

### 特例分析

比如我们考虑例（8）所对应的其次线性方程组：
$$
\left[
	\begin{matrix}
	1 & 1 & 2\\
	2 & 1 & 3\\
	3 & 1 & 4\\
	4 & 1 & 5
	\end{matrix}
\right]
\left[
	\begin{matrix}
	{x}_{1}\\
	{x}_{2}\\
	{x}_{3}
	\end{matrix}
\right]
=
\left[
	\begin{matrix}
	0\\
	0\\
	0\\
	0
	\end{matrix}
\right]
\tag{14}
$$
很明显，一个解为 $$\vec{x}={[-1,-1,1]}^{T}$$ ，当然所有 $$k\vec{x}$$ 也都是解，那么还有与 $$\vec{x}$$ 不共线的解吗？

我们可以设非零解为 $$\vec{x}={[c\lambda_1 ,c\lambda_2,c]}^{T}$$ ，（这里 $$c≠0$$ ，因为 $$c$$ 若等于0，前两列线性无关，得到的就是零解）由于所有 $$k\vec{x}$$ 也都是解，我们不妨取 $$1/c$$ ，即 $$\vec{x}={[\lambda_1,\lambda_2,1]}^{T}$$ ，来剔除线性相关的解，来讨论：**到底有多少线性无关的 $$\vec{x}$$ ？也就是零空间的维数**。

我们知道 $$A$$ 三个列向量的前两个列向量线性无关，也就是前两列是 $$C(A)$$ 的一个基，第三列可以表示成前两列的线性组合：
$$
\vec{a_3}=k_1\vec{a_1}+k_2\vec{a_2}\tag{15}
$$
这种表示方法一定是唯一的。因为若有 $$\vec{a_3}=c_1\vec{a_1}+c_2\vec{a_2}$$ ，且 $${[k_1,k_2]}^T≠{[c_1,c_2]}^T$$ ，那么两式相减，我们可以得到 $$\vec{0}=(c_1-k_1)\vec{a_1}+(c_2-k_2)\vec{a_2}$$ ，又因为 $$a_1,a_2$$ 线性无关，所以只有系数都为0时，其线性组合才为 $$\vec0$$ ，所以得到 $$c_1=k_1$$ ， $$c_2=k_2$$ ，这和我们的假设矛盾，即证明了（10）的表示方法一定是唯一的。

那么 $$\vec{-a_3}=-k_1\vec{a_1}+-k_2\vec{a_2}=\lambda_1\vec{a_1}+\lambda_2\vec{a_2}$$ 的表示方法也一定是唯一的，移项就能得到，使 $$\lambda_1\vec{a_1}+\lambda_2\vec{a_2}+\vec{a_3}=\vec{0}$$ 成立的 $${[\lambda_1,\lambda_2,1]}^{T}$$ ，也就是非零解 $$\vec{x}$$ 也是唯一的，从而原齐次线性方程组

 $$A\vec{x}=\vec{0}$$ 的系数矩阵 $$A$$ 的零空间的维数为一，也就是说：**N(A)是 $$R^n$$ 上的一维向量空间，即 $$R^n$$ 中的一条过原点的直线。**

### 一般分析

有了以上特例分析作为基础，我们就能容易地推广到一般情况。

对于一般的 $$m$$ 行 $$n$$ 列矩阵 $$A$$ ，考虑 $$A$$ 的列向量 $$a_1,a_2,…,a_n$$ ，一定可以（但并不唯一地）分为两部分，即 $$a_1,…,a_r$$ 为列空间的一组基（即最大线性无关组）， $$a_{r+1},…,a_n$$ 为分别可以由基唯一线性表出的列向量。

> 这里的基虽然在原列向量 $$a_1,a_2,…,a_n$$ 内，不一定就是最左边的 $$r$$ 列，但是可以通过交换列向量得到这种形式，相应的零空间内各列向量的位置也需要做相应的调换，比如交换2、4列的位置，那么零空间向量 $${[1,2,3,4]}^T$$ 相应交换2、4行的位置，变成 $${[1,4,3,2]}^T$$ ，但这并不会影响零空间维数这个结果，我们这么做只是为了方便地分析问题。
>

我们任意从后面 $$n-r$$ 个列向量中取某个 $$a_k$$ 系数为1，使其他 $$n-r-1$$ 个系数均为0，同样的分析思路，我们有使
$$
\lambda_1\vec{a_1}+\lambda_2\vec{a_2}+...+\lambda_r\vec{a_r}+\vec{a_k}=\vec{0}
\tag{16}
$$
成立的 $${[\lambda_1,\lambda_2,…,\lambda_r,0_{r+1},0_{k-1},0_k,0_{k+1},…,0_n]}^{T}$$ 是唯一的，由于我们假设的一般性，这样的列向量有 $$n-r$$ 个，也就是说至少有 $$n-r$$ 个线性无关的 $$n$$ 维向量在零空间中，即零空间至少 $$n-r$$ 维。

尝试写出这 $$n-r$$ 个向量：
$$
\left[
	\begin{matrix}
	\lambda_{1(r+1)} \\
	\lambda_{2(r+1)} \\
	... \\
	\lambda_{r(r+1)}\\
	1\\
  0\\
  ...\\
  0
	\end{matrix}
\right]
\left[
	\begin{matrix}
	\lambda_{1(r+2)} \\
	\lambda_{2(r+2)} \\
	... \\
	\lambda_{r(r+2)}\\
	0\\
  1\\
  ...\\
  0
	\end{matrix}
\right]...
\left[
	\begin{matrix}
	\lambda_{1(n)} \\
	\lambda_{2(n)} \\
	... \\
	\lambda_{r(n)}\\
	0\\
  0\\
  ...\\
  1
	\end{matrix}
\right]
\tag{17}
$$
这下我们就能很容易看出为什么要取一个为1，其他都为0，目的就是为了一定能得到 $$n-r$$ 个线性无关且各自唯一表示的列向量。

**那么有可能还有其他的线性无关的向量吗？**

也就是比如我们再随便给出一个列向量：
$$
{\vec{x}}^*={[\lambda_1,\lambda_2,...,\lambda_r,c_{r+1},c_{r+2},...,c_n]}^{T}
\tag{18}
$$


想要使 $$A{\vec{x}}^*=\vec{0}$$ ，且与（12）我们已经得到的 $$n-r$$ 个解线性无关。这是不可能的。

我们用反证法来证明这个命题，现在有一个 $${\vec{x}}^*$$ 满足“想要使 $$A{\vec{x}}^*=\vec{0}$$ ，且与（12）我们已经得到的 $$n-r$$ 个解线性无关”这个**假设**，那么，我们一定可以将 $${\vec{x}}^*$$ 表示成如下的形式：
$$
{\vec{x}}^*=
c_{r+1}
\left[
	\begin{matrix}
	\lambda_{1(r+1)} \\
	\lambda_{2(r+1)} \\
	... \\
	\lambda_{r(r+1)}\\
	1\\
  0\\
  ...\\
  0
	\end{matrix}
\right]
+c_{r+2}
\left[
	\begin{matrix}
	\lambda_{1(r+2)} \\
	\lambda_{2(r+2)} \\
	... \\
	\lambda_{r(r+2)}\\
	0\\
  1\\
  ...\\
  0
	\end{matrix}
\right]+...+c_{n}
\left[
	\begin{matrix}
	\lambda_{1(n)} \\
	\lambda_{2(n)} \\
	... \\
	\lambda_{r(n)}\\
	0\\
  0\\
  ...\\
  1
	\end{matrix}
\right]
+
\left[
	\begin{matrix}
	{\lambda_{1}}^* \\
	{\lambda_{2}}^* \\
	... \\
	{\lambda_{r}}^*\\
	0\\
  0\\
  ...\\
  0
	\end{matrix}
\right]
\tag{19}
$$
简写为：
$$
{\vec{x}}^*= c_{r+1}\vec{x_{r+1}}+c_{r+2}\vec{x_{r+2}}+...+c_n\vec{x_{r+n}}+{\vec{x_s}}^*
\tag{20}
$$
关键来了， $${\vec{x_s}}^*$$ 一定不是零向量，因为这是我们**假设要求的线性无关**。

然后我们在（15）等式两端乘以 $$A$$ ，便得到：
$$
A{\vec{x}}^*= c_{r+1}A\vec{x_{r+1}}+c_{r+2}A\vec{x_{r+2}}+...+c_nA\vec{x_{r+n}}+A{\vec{x_s}}^*
\\
\vec0= c_{r+1}\vec0+c_{r+2}\vec0+...+c_n\vec0+A{\vec{x_s}}^*
\\
A{\vec{x_s}}^*=\vec0
\tag{21}
$$
再以列向量的线性组合表示出来：
$$
{\lambda_{1}}^*\vec a_1+{\lambda_{2}}^*\vec a_2+...+{\lambda_{r}}^*\vec a_r+0\vec a_{r+1}+0\vec a_{r+2}+...+0\vec a_{n}=\vec{0}
\tag{22}
$$

$$
{\lambda_{1}}^*\vec a_1+{\lambda_{2}}^*\vec a_2+...+{\lambda_{r}}^*\vec a_r=\vec{0}\tag{23}
$$

由（18）式，我们得到了 $$a_1,…,a_r$$ 线性相关，这和我们最开始的假定是矛盾的，所以我们由反证法得出，不存在更多线性无关的解了，也就是说 $$dim\space N(A)=n-r$$ ， $$r$$ 为 $$A$$ 的秩。

当然，以上这种证明只是我自己做笔记时想出来的，肯定很繁琐，之后学习了矩阵的秩会有相关性质进行简洁的证明。

综合列空间，我们可以得到，对于 $$A_{mn}$$ ，若 $$rank(A)=r$$ ，则有：
$$
dim \space C(A)=r,dim \space N(A)=n-r
\tag{24}
$$

列空间和零空间对于理解非齐次线性方程组的解是非常有帮助的，列空间告诉我们什么时候有解什么时候无解，零空间告诉我们，解的结构应该是什么样子。



# 7 $$A\vec{x}=\vec{0}$$ 的求解

## 思路

考虑以下 $$A$$ ，并进行行变换得到简化阶梯型矩阵 $$R$$ ：
$$
A=
\left[
	\begin{matrix}
	1 & 2 & 2 & 2 \\
	2 & 4 & 6 & 8 \\
	3 & 6 & 8 & 10
	\end{matrix}
\right]
\sim
\left[
	\begin{matrix}
	1 & 2 & 2 & 2 \\
	0 & 0 & 2 & 4 \\
	0 & 0 & 0 & 0
	\end{matrix}
\right]
\sim
\left[
	\begin{matrix}
	1 & 2 & 0 & -2 \\
	0 & 0 & 1 & 2 \\
	0 & 0 & 0 & 0
	\end{matrix}
\right]
=R
\tag{25}
$$
现在，记：
$$
I_{r×r}=
\left[
	\begin{matrix}
	1 & 0 \\
	0 & 1 
	\end{matrix}
\right]
,
F_{r×(n-r)}=
\left[
	\begin{matrix}
	2 & -2 \\
	0 & 2 
	\end{matrix}
\right]
\tag{26}
$$


那么 $$R$$ 可以表示为：
$$
R_{m×n}=
\left[
	\begin{matrix}
	I_{r×r} & F_{r×(n-r)} \\
	\vec0_{(m-r)×r} & \vec0_{(m-r)×(n-r)} 
	\end{matrix}
\right]
\tag{27}
$$
设 $$N_{n×(n-r)}$$ 为：
$$
N_{n×(n-r)}=
\left[
	\begin{matrix}
	-F_{r×(n-r)} \\
	I_{n-r} 
	\end{matrix}
\right]
\tag{28}
$$




接下来计算 $$RN$$ ：
$$
R_{m×n}N_{n×(n-r)}=
\left[
	\begin{matrix}
	-F_{r×(n-r)}+F_{r×(n-r)} \\
	\vec0_{(m-r)×(n-r)}+\vec0_{(m-r)×(n-r)} 
	\end{matrix}
\right]
=
\left[
	\begin{matrix}
	\vec0_{r×(n-r)} \\
	\vec0_{(m-r)×(n-r)}
	\end{matrix}
\right]=
\vec{0}
\tag{29}
$$


这样我们就找出了 $$A\vec{x}=\vec{0}$$ 的一组解 $$N_{n×(n-r)}$$ 。



## 计算机求解的过程

第一步，通过消元找出 $$R$$ 。

第二步，找出主元变量和自由变量。

第三步，给自由变量赋值0和1，并通过回代解出主变量。

举个例子：
$$
A=
\left[
	\begin{matrix}
	1 & 2 & 3 \\
	2 & 4 & 6 \\
	2 & 6 & 8 \\
	2 & 8 & 10
	\end{matrix}
\right]
\sim
\left[
	\begin{matrix}
	1 & 0 & 1 \\
	0 & 1 & 1 \\
	0 & 0 & 0 \\
	0 & 0 & 0
	\end{matrix}
\right]
\\
I=
\left[
	\begin{matrix}
	1 & 0 \\
	0 & 1
	\end{matrix}
\right]
,
F=
\left[
	\begin{matrix}
	1  \\
	1
	\end{matrix}
\right]
\tag{30}
$$
由（23）可知解的形式为：
$$
N_{3×1}=
\left[
	\begin{matrix}
	-F_{2×1} \\
	I_{1} 
	\end{matrix}
\right]
=
\left[
	\begin{matrix}
	-1\\
	-1\\
	1
	\end{matrix}
\right]
\tag{31}
$$
所以原齐次线性方程组的通解为：
$$
\vec{x}=k
\left[
	\begin{matrix}
	-1\\
	-1\\
	1
	\end{matrix}
\right]
\tag{32}
$$
其中， $$k$$ 为任意实数。



# 8 $$A\vec{x}=\vec{b}$$ 的求解

在了解了列空间和零空间之后，就可以对 $$A\vec{x}=\vec{b}$$ 何时有解和解的结构进行分析了。

## $$A\vec{x}=\vec{b}$$ 何时有解？

以下两命题等价：

- 当 $$\vec{b} \in C(A)$$ 时， $$A\vec{x}=\vec{b}$$ 有解。
- 当 $$rank(A)=rank(A,\vec{b})$$ 时， $$A\vec{x}=\vec{b}$$ 有解。

具体而言， $$n$$ 元线性方程组 $$A\vec{x}=\vec{b}$$ ：

- 无解的充要条件是 $$rank(A)<rank(A,\vec{b})$$ 。
- 有唯一解的充要条件是 $$rank(A)=rank(A,\vec{b})=n$$ 。
- 有无穷多解的充要条件是 $$rank(A)=rank(A,\vec{b})<n$$ 。

接下来从简化行阶梯型 $$R$$ 来分类：
$$
\begin{matrix} r=m=n \\ R=I \\ 一解 \end{matrix}\space,\space
\begin{matrix} r=m<n \\ R=\left[ \begin{matrix} I & F \end{matrix} \right]  \\ 无穷解 \end{matrix} \space,\space 
\begin{matrix} r=n<m \\ R=\left[ \begin{matrix} I \\ 0 \end{matrix} \right]  \\ 无解或一解 \end{matrix} \space,\space 
\begin{matrix} r<m,r<n \\ R=\begin{bmatrix} I & F \\ 0 & 0 \end{bmatrix} \\ 无解或无穷解 \end{matrix}
\tag{33}
$$


## $$A\vec{x}=\vec{b}$$ 解的结构

非齐次线性方程组 $$A\vec{x}=\vec{b}$$ 的通解为齐次线性方程组 $$A\vec{x}=\vec{0}$$ 的通解，加上非齐次线性方程组的任一特解$$\vec{x}^*$$：
$$
\vec{x}=
\left[
	\begin{matrix}
	-F_{r×(n-r)} \\
	I_{n-r} 
	\end{matrix}
\right]
\left[
	\begin{matrix}
	k_1 \\
	&\ddots\\
	&&k_{n-r} 
	\end{matrix}
\right]+
\vec{x}^*
\tag{34}
$$
